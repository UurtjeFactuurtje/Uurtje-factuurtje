version: '3.4'

services:
    hourregistrationapi:
        image: ${DOCKER_REGISTRY-}hourregistrationapi
        ports:
        - "80:80"
        - "443:443"
        build:
            context: .
            dockerfile: HourRegistrationAPI/Dockerfile
        depends_on: 
        - rabbitmq


    hourregistrationconsumer:
        image: ${DOCKER_REGISTRY-}hourregistrationconsumer
        build:
            context: .
            dockerfile: "../HourRegistrationConsumer/Dockerfile"
        depends_on: 
        - rabbitmq


    rabbitmq:
        image: rabbitmq:3-management
        container_name: rabbitmq
        restart: on-failure
        ports:
        - "15672:15672"
        - "5672:5672"

